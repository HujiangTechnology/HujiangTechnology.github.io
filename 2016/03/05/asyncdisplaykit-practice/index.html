<!DOCTYPE HTML>
<html>
<head>
  <meta charset="utf-8">
  
  <title>æ·±åº¦å®è·µ AsyncDisplayKit | ç§»åŠ¨å¼€å‘</title>
  <meta name="author" content="ç§»åŠ¨å¼€å‘">
  
  <meta name="description" content="è¿™é‡Œèƒ½å­¦åˆ°æœ€æ–°æœ€ç‰›çš„æŠ€æœ¯ï¼Œå¸®ä½ è§„åˆ’å¤§ç‰›ä¹‹é“ã€‚">
  
  
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  <meta property="og:title" content="æ·±åº¦å®è·µ AsyncDisplayKit"/>
  <meta property="og:site_name" content="ç§»åŠ¨å¼€å‘"/>

  
    <meta property="og:image" content="undefined"/>
  

  
  
    <link href="/https://avatars3.githubusercontent.com/u/13547892?v=3&s=200" rel="icon">
  

  <!-- CSS -->
  <link rel="stylesheet" href="/css/themes/flatly.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/font-awesome.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/style.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/responsive.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/highlight.css" media="screen" type="text/css">
  <link rel="stylesheet" href="/css/google-fonts.css" media="screen" type="text/css">
  <!--[if lt IE 9]><script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->

  <script src="/js/jquery-2.0.3.min.js"></script>

  <!-- analytics -->
  



</head>

 <body>  
  <nav id="main-nav" class="navbar navbar-inverse navbar-default navbar-fixed-top" role="navigation">
    <div class="container">
      <button type="button" class="navbar-header navbar-toggle" data-toggle="collapse" data-target=".navbar-collapse">
	<span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
       <a class="navbar-brand" href="/">ç§»åŠ¨å¼€å‘</a>
      <div class="collapse navbar-collapse nav-menu">
		<ul class="nav navbar-nav">
		  
		  <li>
			<a href="/tags/iOSæŠ€æœ¯å‘¨åˆŠ/" title="æŠ€æœ¯å‘¨åˆŠ">
			  <i class="fa fa-apple"></i>å‘¨åˆŠ
			</a>
		  </li>
		  
		  <li>
			<a href="/archives" title="All the articles.">
			  <i class="fa fa-archive"></i>å½’æ¡£
			</a>
		  </li>
		  
		  <li>
			<a href="/about" title="About me.">
			  <i class="fa fa-user"></i>å…³äº
			</a>
		  </li>
		  
		  <li>
			<a href="/atom.xml" title="Feed">
			  <i class="fa fa-rss"></i>RSS
			</a>
		  </li>
		  
		</ul>
      </div>
    </div> <!-- container -->
</nav>
<div class="clearfix"></div>

  <div class="container">
  	<div class="content">
    	 


	
		<div class="page-header page-header-inverse ">		
			<h1 class="title title-inverse "> æ·±åº¦å®è·µ AsyncDisplayKit</h1>
		</div>		
	






<div class="row post">
	<!-- cols -->
	
	<div id="top_meta"></div>
	<div class="col-md-9">
	

	<!-- content -->
	<div class="mypage">		
	  		

	  <p>è¿½æ±‚æè‡´çš„ç”¨æˆ·ä½“éªŒï¼Œä»æ¥éƒ½æ˜¯æˆ‘ä»¬é”²è€Œä¸èˆçš„è¿½æ±‚ï¼Œå¯¹äºiOSç”¨æˆ·è€Œè¨€ï¼Œè¿™æ›´æ˜¯å®¹ä¸å¾—ä¸€ç‚¹é©¬è™ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œç°å¦‚ä»Šï¼Œè°è¿˜èƒ½å¿å—å¾—äº†ä¸€ä¸ªé¡µé¢æ‰“å¼€åï¼ŒåŠå¤©æ²¡æœ‰ç»“æœğŸ˜­ï¼Œå‡ºæ¥ä¹‹åæ»‘åŠ¨å¡é¡¿ï¼Œç‚¹å‡»ä¸ªæŒ‰é’®åŠå¤©æœ¨æœ‰ååº”å•Šï¼Œæœ‰æœ¨æœ‰ï¼Ÿè¿˜å¥½ï¼Œè¿˜æœ‰<code>Facebook</code>ï¼Œè¿™ä½äº’è”ç½‘ITç•Œçš„å¤§ä½¬ï¼Œä¸ºæˆ‘ä»¬å¸¦æ¥äº†ç¦éŸ³ï¼Œå®ƒå°±æ˜¯æˆ‘ä»¬ä»Šå¤©è¦è®²çš„<code>AsyncDisplayKit</code>ã€‚</p>
<a id="more"></a>
<h2 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h2><p><code>AsyncDisplayKit</code> å¯ä»¥ç»™æˆ‘ä»¬å¸¦æ¥å¾ˆæ£’çš„ç”¨æˆ·ä½“éªŒï¼Œä¸»è¦æ˜¯é€šè¿‡ä¼˜åŒ–ä»¥ä¸‹3ç‚¹ï¼š</p>
<ul>
<li>å›¾åƒè§£ç </li>
<li>é¡µé¢å¸ƒå±€</li>
<li>é¡µé¢å…ƒç´ æ¸²æŸ“</li>
</ul>
<p>é€šè¿‡æŠŠä»¥ä¸Šå‡ é¡¹æ“ä½œæ”¾åœ¨åå°çº¿ç¨‹ï¼Œä»è€Œé¿å…äº†é˜»å¡ç”¨æˆ·ä¸»çº¿ç¨‹ã€‚æ‰€ä»¥ï¼Œé€šè¿‡è¿™ä¸ªåº“ï¼Œå¦‚æœä½¿ç”¨å¾—å½“ï¼Œå³ä½¿æ˜¯å¤æ‚çš„é¡µé¢å¸ƒå±€æˆ‘ä»¬ä»å¯ä»¥è·å¾—ä¸æ»‘èˆ¬çš„æ— é™æ¥è¿‘60FPSçš„é¡µé¢æ»šåŠ¨ä½“éªŒï¼Œè¿™ä¸€ç‚¹ï¼Œé€šè¿‡å¸¸è§„çš„<code>UIKit</code>ä¼˜åŒ–ä¸€èˆ¬æ˜¯è¾¾ä¸åˆ°è¿™ä¸ªæ•ˆæœçš„ğŸ˜ã€‚</p>
<p>åœ¨æœ¬æ–‡ä¸­ï¼Œæˆ‘ä»¬é€šè¿‡ä¸€ä¸ªå¼€å§‹çš„åˆçº§é¡¹ç›®ï¼ˆä¸»è¦æ˜¯ä½¿ç”¨äº†<code>UICollectionView</code>ï¼Œæœ‰ä¸€äº›æ»šåŠ¨ä½“éªŒä¸ä½³ï¼‰ï¼Œé€šè¿‡ä½¿ç”¨<code>AsyncDisplayKit</code>æ¥ä¼˜åŒ–æå‡å®ƒçš„æ€§èƒ½ã€‚è·Ÿç€æˆ‘èµ°ï¼Œä½ å°†ä¼šå­¦ä¼šå¦‚ä½•åœ¨ä½ è‡ªå·±çš„é¡¹ç›®ä¸­ä½¿ç”¨  <code>AsyncDisplayKit</code> ã€‚</p>
<p>&gt;<br>æ³¨æ„: åœ¨å¼€å§‹ä¹‹å‰, ä½ æœ€å¥½å¯¹ Swift, Core Animation å’Œ Core Graphicsè¿™äº›çŸ¥è¯†å·²ç»æœ‰æ‰€äº†è§£.</p>
<h2 id="å¼€å§‹äº†"><a href="#å¼€å§‹äº†" class="headerlink" title="å¼€å§‹äº†"></a>å¼€å§‹äº†</h2><p>å¼€å§‹ä¹‹å‰ï¼Œå¦‚æœæœ‰æ—¶é—´çš„è¯ï¼Œä½ æœ€å¥½çœ‹ä¸€ä¸‹<a href="https://code.facebook.com/posts/721586784561674/introducing-AsyncDisplayKit-for-smooth-and-responsive-apps-on-ios/" target="_blank" rel="external">AsyncDisplayKitçš„ä»‹ç»</a>ï¼Œè¿™æ ·ä½ ä¼šå¯¹ <code>AsyncDisplayKit</code>çš„ä¸»è¦åŠŸèƒ½æœ‰ä¸€ä¸ªåˆæ­¥çš„è®¤è¯†ã€‚é¡¹ç›®æºç <em>(EMAIL ME:1043370115@QQ.COM)</em>ï¼Œå…ˆè·‘èµ·æ¥çœ‹çœ‹ï¼ˆéœ€è¦Xcode 6.3 å’Œ the iOS 8.3 SDK ä»¥ä¸Šç¯å¢ƒï¼‰ã€‚ä¸ºäº†èƒ½æ¯”è¾ƒæ˜æ˜¾çš„çœ‹åˆ°ä½¿ç”¨è¿™ä¸ªåº“çš„å·®å¼‚ï¼Œæœ€å¥½åœ¨è€ä¸€ç‚¹çš„è®¾å¤‡ä¸Šè¿è¡Œï¼Œå¦‚æœæ˜¯æ¨¡æ‹Ÿå™¨ï¼Œçœ‹åˆ°çš„æ€§èƒ½æå‡ä¸æ˜æ˜¾ï¼Œä½ æ‡‚çš„ğŸ˜ã€‚è¿è¡Œèµ·æ¥ï¼Œçœ‹èµ·æ¥æ˜¯è¿™æ ·çš„:<br><img src="http://cdn4.raywenderlich.com/wp-content/uploads/2014/10/IMG_0002.png" alt=""><br>åƒä½ ç°åœ¨çœ‹åˆ°çš„ï¼Œè¿™ä¸ªappçš„ä¸»é¡µé¢æ˜¯ä¸€ä¸ªä¼—å¤šåŠ¨ç‰©å¡ç‰‡ç»„æˆçš„ä¸€ä¸ª<code>UICollectionView</code>,æ¯ä¸€ä¸ªå¡ç‰‡åŒ…å«äº†ä¸€å¼ å›¾ç‰‡ï¼Œä¸€æ¡æ–‡å­—æè¿°ï¼Œä»¥åŠä¸€ä¸ªç”±ä¸»å›¾ç‰‡ç»è¿‡æ¨¡ç³Šå¤„ç†çš„èƒŒæ™¯ã€‚<br></p>
<p> æ»šåŠ¨ä¸€ä¸‹è¿™ä¸ªé¡µé¢ï¼Œæ³¨æ„å®ƒçš„å¸§ç‡ï¼Œï¼ˆæˆ‘ä½¿ç”¨çš„æ˜¯iPad 3ï¼Œå¤§æ¦‚åªæœ‰20FPSï¼‰ï¼Œå¤±å¸§å¾ˆä¸¥é‡å•Šï¼Œæ‰€ä»¥ä½ çš„ç›´è§‚è§¦è§‰å°±æ˜¯ç•Œé¢å¾ˆä¸æµç•…ï¼Œå¡é¡¿å®å®åœ¨åœ¨çš„ã€‚å¥½å§ï¼Œåœ¨è¿™ç¯‡æ–‡ç« ç»“æŸçš„æ—¶å€™ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯è¦æŠŠå®ƒæåˆ°ï¼ˆæˆ–è€…æ— é™æ¥è¿‘ï¼‰60FPSã€‚<br></p>
<p> &gt;<br> æ³¨æ„: è¿™ä¸ªé¡¹ç›®é‡Œä½ çœ‹åˆ°çš„æ‰€æœ‰å›¾ç‰‡éƒ½æ˜¯æ”¾åœ¨æœ¬åœ°åœ°èµ„æºæ–‡ä»¶é‡Œé¢çš„ï¼Œæ²¡æœ‰ä¸€ä¸ªæ˜¯ä»ç½‘ç»œä¸‹è½½æ¥çš„ã€‚</p>
<h2 id="æµ‹è¯•å“åº”èƒ½åŠ›"><a href="#æµ‹è¯•å“åº”èƒ½åŠ›" class="headerlink" title="æµ‹è¯•å“åº”èƒ½åŠ›"></a>æµ‹è¯•å“åº”èƒ½åŠ›</h2><p>åœ¨ä½¿ç”¨<code>AsyncDisplayKit</code>ä¼˜åŒ–ä½ çš„é¡¹ç›®ä¹‹å‰ï¼Œå…ˆé€šè¿‡<code>Instruments</code>æ¥æ£€æµ‹ä¸€ä¸‹ä½ çš„åº”ç”¨çš„å“åº”èƒ½åŠ›ï¼Œè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼Œå¯ä»¥ç¡®ä¿ä½ çŸ¥é“ä¼˜åŒ–å<code>AsyncDisplayKit</code>ç»™ä½ å¸¦æ¥äº†ä»€ä¹ˆå˜åŒ–ã€‚<br><br>æœ€é‡è¦çš„æ˜¯ï¼Œå½±å“æ€§èƒ½çš„å› ç´ ä¸­ï¼Œæ— éå°±æ˜¯<code>CPU</code>ï¼Œ<code>GPU</code>è¿™ä¸¤å—ï¼Œæ‰€ä»¥ä¼˜åŒ–å‰ï¼Œä½ åº”è¯¥é¦–å…ˆå¼„æ¸…æ¥šä½ çš„æ€§èƒ½ç“¶é¢ˆåœ¨å“ªé‡Œï¼Œç©¶ç«Ÿæ˜¯å—åˆ¶äº<code>CPU</code>è¿˜æ˜¯<code>GPU</code>ï¼Œæ˜¯å“ªä¸€ä¸ªé™ä½äº†ä½ åº”ç”¨çš„FPSã€‚ææ¸…æ¥šè¿™ä¸ªä¹‹åï¼Œä½ å¯ä»¥çœ‹åˆ°<code>AsyncDisplayKit</code>æ˜¯å¦‚ä½•åˆ©ç”¨å®ƒçš„ç‰¹æ€§æ¥å¸®ä½ ä¼˜åŒ–çš„ã€‚<br><br>å¦‚æœä½ æœ‰æ—¶é—´çš„è¯ï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Instruments</code>æ¥ç›‘æµ‹ä¸€ä¸‹æˆ‘ä»¬ä¸€å¼€å§‹æä¾›çš„é‚£ä¸ªé¡¹ç›®çš„æ€§èƒ½ç“¶é¢ˆï¼Œä½ ä¼šå‘ç°å®ƒæ˜¯å—åˆ¶äº<code>CPU</code>çš„ã€‚</p>
<h2 id="å‡†å¤‡åˆ‡æ¢åˆ°AsyncDisplayKit"><a href="#å‡†å¤‡åˆ‡æ¢åˆ°AsyncDisplayKit" class="headerlink" title="å‡†å¤‡åˆ‡æ¢åˆ°AsyncDisplayKit"></a>å‡†å¤‡åˆ‡æ¢åˆ°AsyncDisplayKit</h2><p>åœ¨å·²å­˜åœ¨çš„é¡¹ç›®ä¸Šä½¿ç”¨<code>AsyncDisplayKit</code>å¾ˆç®€å•ï¼Œå°±æ˜¯æŠŠ<code>view hierarchies</code>æˆ–è€…/å’Œ <code>layer trees</code>æ›¿æ¢ä¸º<code>display node hierarchies</code>ã€‚  <code>Display nodes</code>æ˜¯<code>AsyncDisplayKit</code>ä¸­å¾ˆé‡è¦çš„ä¸€ä¸ªæ¦‚å¿µï¼Œå®ƒæ˜¯åŸºäºviewsä¹‹ä¸Šå¹¶ä¸”çº¿ç¨‹å®‰å…¨çš„ï¼Œè¿™æ„å‘³ç€æˆ‘ä»¬å¹³å¸¸ä¹ æƒ¯äºåœ¨ä¸»çº¿ç¨‹ä¸­åšçš„é‚£äº›viewsæœ‰å…³çš„éƒ¨åˆ†å·¥ä½œç°åœ¨å¯ä»¥è„±ç¦»ä¸»çº¿ç¨‹äº†ï¼Œæ˜¯ä¸æ˜¯å¾ˆæƒŠå¥‡ï¼Ÿæ²¡é”™ï¼Œè¿™å°±æ˜¯æœ€å¤§çš„é­…åŠ›æ‰€åœ¨ï¼Œæ‰€ä»¥ä½ å°±å¯ä»¥æŠŠæœ‰é™çš„èµ„æºå»å¤„ç†æ›´é‡è¦çš„äº‹æƒ…äº†ï¼Œæ¯”å¦‚<code>touch event</code>æˆ–è€…<code>scroll view</code>çš„æ»šåŠ¨ã€‚æ‰€ä»¥æ¥ä¸‹æ¥ç¬¬ä¸€æ­¥ï¼Œå°±æ˜¯å»æ‰<code>view hierarchy</code>ã€‚<br></p>
<h3 id="Removing-the-View-Hierarchy"><a href="#Removing-the-View-Hierarchy" class="headerlink" title="Removing the View Hierarchy"></a>Removing the View Hierarchy</h3><p>æ‰“å¼€ <code>RainforestCardCell.swift</code>ï¼Œåœ¨ <code>awakeFromNib()</code> åˆ é™¤æ‰€æœ‰çš„ <code>addSubview(...)</code> è°ƒç”¨, åƒè¿™æ ·:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">super</span>.awakeFromNib()</span><br><span class="line">  contentView.layer.borderColor =</span><br><span class="line">    <span class="type">UIColor</span>(hue: <span class="number">0</span>, saturation: <span class="number">0</span>, brightness: <span class="number">0.85</span>, alpha: <span class="number">0.2</span>).<span class="type">CGColor</span></span><br><span class="line">  contentView.layer.borderWidth = <span class="number">1</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢<code>layoutSubviews()</code> ä¸ºä¸‹é¢çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">  		<span class="keyword">super</span>.layoutSubviews()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ›¿æ¢<code>configureCellDisplayWithCardInfo(cardInfo:)</code> ä¸ºä¸‹é¢çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">configureCellDisplayWithCardInfo</span><span class="params">(cardInfo: RainforestCardInfo)</span></span> &#123;</span><br><span class="line">  <span class="comment">//MARK: Image Size Section</span></span><br><span class="line">  <span class="keyword">let</span> image = <span class="type">UIImage</span>(named: cardInfo.imageName)!</span><br><span class="line">  featureImageSizeOptional = image.size</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åˆ é™¤<code>RainforestCardCell</code>ä¸­æ‰€æœ‰çš„<code>view</code>å±æ€§ï¼Œå‰©ä¸‹æ¥çš„åƒè¿™æ ·ï¼š<br></p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RainforestCardCell</span>: <span class="title">UICollectionViewCell</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> featureImageSizeOptional: <span class="type">CGSize</span>?</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç„¶åä¿å­˜å¹¶è¿è¡Œï¼Œç»“æœåƒè¿™æ ·ï¼š<br><img src="http://www.raywenderlich.com/wp-content/uploads/2014/10/IMG_0001.jpg" alt=""><br>ç°åœ¨éƒ½æ˜¯ä¸€äº›ç©ºçš„cells,æ‰€ä»¥ä½ æ»šåŠ¨èµ·æ¥ç›¸å½“é¡ºæ»‘ï¼Œæˆ‘ä»¬çš„ç›®æ ‡å°±æ˜¯å½“è¿™äº›cellå¡«ä¸Šå†…å®¹ä¹‹åï¼Œä»ç„¶ä¿æŒè¿™æ ·çš„è§¦æ„Ÿã€‚åœ¨ä½ æ¯åšä¸€æ­¥ä¹‹åï¼Œä½ å¯ä»¥ä½¿ç”¨<code>Instrumentsâ€™s Core Animation template</code>æ¥è§‚å¯Ÿappçš„å¸§ç‡æœ‰ä»€ä¹ˆå˜åŒ–ã€‚<br></p>
<h3 id="Adding-a-Placeholder"><a href="#Adding-a-Placeholder" class="headerlink" title="Adding a Placeholder"></a>Adding a Placeholder</h3><p>åœ¨<code>RainforestCardCell.swift</code>ä¸­æ·»åŠ ä¸€ä¸ªå±æ€§<code>placeholderLayer</code>ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RainforestCardCell</span>: <span class="title">UICollectionViewCell</span> </span>&#123;</span><br><span class="line">  	<span class="keyword">var</span> featureImageSizeOptional: <span class="type">CGSize</span>?</span><br><span class="line">  	<span class="keyword">var</span> placeholderLayer: <span class="type">CALayer</span>!</span><br><span class="line">  		...</span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p>ä½¿ç”¨placeholderæ˜¯å› ä¸ºæˆ‘ä»¬çš„cellçš„å†…å®¹å±•ç¤ºçš„æ—¶å€™æ˜¯å¼‚æ­¥çš„ï¼Œä¸ºäº†ä¸è®©ç”¨æˆ·çœ‹åˆ°ç©ºçš„cellã€‚è¿™å°±åƒæˆ‘ä»¬ä»ç½‘ç»œä¸‹è½½å›¾ç‰‡çš„æ—¶å€™çš„åšæ³•ä¸€æ ·ï¼Œå½“å›¾ç‰‡ä¸‹è½½å®Œæˆä¹‹å‰å…ˆè®¾ç½®ä¸€ä¸ªplaceholderã€‚</p>
<p>åœ¨<code>awakeFromNib()</code>ä¸­ï¼Œé…ç½®<code>placeholderLayer</code>ï¼Œç„¶åè¯¥æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">awakeFromNib</span><span class="params">()</span></span> &#123;</span><br><span class="line">   	<span class="keyword">super</span>.awakeFromNib()</span><br><span class="line">  	placeholderLayer = <span class="type">CALayer</span>()</span><br><span class="line">  	placeholderLayer.contents = 	<span class="type">UIImage</span>(named:<span class="string">"cardPlaceholder"</span>)!.<span class="type">CGImage</span></span><br><span class="line">  	placeholderLayer.contentsGravity = kCAGravityCenter</span><br><span class="line">  	placeholderLayer.contentsScale = <span class="type">UIScreen</span>.mainScreen().scale</span><br><span class="line">   	placeholderLayer.backgroundColor = <span class="type">UIColor</span>(hue: <span class="number">0</span>, saturation: <span class="number">0</span>, 		brightness: <span class="number">0.85</span>, alpha: <span class="number">1</span>).<span class="type">CGColor</span></span><br><span class="line">  	contentView.layer.addSublayer(placeholderLayer)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨ <code>layoutSubviews()</code>, åŠ è½½<code>placeholderLayer</code>,ä¿®æ”¹åçš„æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">  	<span class="keyword">super</span>.layoutSubviews()</span><br><span class="line">  	placeholderLayer?.frame = bounds</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘è¿è¡Œï¼Œçœ‹èµ·æ¥æ˜¯è¿™æ ·ï¼š<br><img src="http://www.raywenderlich.com/wp-content/uploads/2014/10/IMG_0003.png" alt=""></p>
<p>æ™®é€šçš„<code>CALayers</code>å•ç‹¬ä½¿ç”¨ï¼Œæ²¡æœ‰ä¸viewå…³è”çš„æ—¶å€™ï¼Œå½“ä½ æ”¹å˜frameçš„æ—¶å€™å®ƒä»¬ä¼šæœ‰ä¸€ä¸ªéšå¼çš„åŠ¨ç”»ï¼Œæ‰€ä»¥ä½ åº”è¯¥ä¼šçœ‹åˆ°å½“é‚£ä¸ªlayeråŠ è½½å‡ºæ¥çš„æ—¶å€™æœ‰ä¸€ä¸ªç¼©æ”¾çš„åŠ¨ç”»ï¼Œä¸ºäº†ä¿®æ”¹è¿™ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬é‡å†™<code>layoutSubviews</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">layoutSubviews</span><span class="params">()</span></span> &#123;</span><br><span class="line">  <span class="keyword">super</span>.layoutSubviews()</span><br><span class="line">  <span class="type">CATransaction</span>.begin()</span><br><span class="line">  <span class="type">CATransaction</span>.setValue(kCFBooleanTrue,</span><br><span class="line">  forKey:kCATransactionDisableActions)</span><br><span class="line">  placeholderLayer?.frame = bounds</span><br><span class="line">  <span class="type">CATransaction</span>.commit()</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>é‡æ–°ç¼–è¯‘è¿è¡Œï¼Œä½ ä¼šå‘ç°åˆšæ‰çš„é—®é¢˜è§£å†³äº†ã€‚</p>
<h2 id="Your-First-Node"><a href="#Your-First-Node" class="headerlink" title="Your First Node"></a>Your First Node</h2><p>æˆ‘ä»¬è¦é‡æ„è¿™ä¸ªappçš„ç¬¬ä¸€æ­¥å°±æ˜¯æ·»åŠ ä¸€ä¸ªnodeï¼Œåœ¨è¿™ä¸€éƒ¨åˆ†ï¼Œæˆ‘ä»¬å°†è¦å¤„ç†ä»¥ä¸‹å‡ ä¸ªä»»åŠ¡ï¼š<br></p>
<ul>
<li>åˆ›å»ºï¼Œå¸ƒå±€ï¼Œæ·»åŠ  node åˆ° cell ä¸­</li>
<li>é‡ç”¨ cell ä»¥åŠå…¶ä¸­çš„ node å’Œ layer</li>
<li>å¯¹ image node åš blur å¤„ç† </li>
</ul>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨ <code>Layers-Bridging-Header.h</code>ä¸­å¯¼å…¥<code>AsyncDisplayKit</code>:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">#<span class="keyword">import</span> &lt;AsyncDisplayKit/AsyncDisplayKit.h&gt;</span><br></pre></td></tr></table></figure>
<h3 id="é¡¹ç›®ç»“æ„æ¢³ç†"><a href="#é¡¹ç›®ç»“æ„æ¢³ç†" class="headerlink" title="é¡¹ç›®ç»“æ„æ¢³ç†"></a>é¡¹ç›®ç»“æ„æ¢³ç†</h3><ul>
<li>View Controller : <code>RainforestViewController</code> å®é™…ä¸Šä¸åšä»€ä¹ˆäº‹æƒ…ï¼Œåªæ˜¯ç®€å•çš„è·å¾—æ•°æ®æºå¹¶å®ç°<code>UICollectionView</code>çš„ä»£ç†ã€‚</li>
<li>Data Source : view controller ç”Ÿæˆå¹¶é‡ç”¨cellï¼Œé€šè¿‡è°ƒç”¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>é…ç½®cellã€‚</li>
<li>Cell : åœ¨ <code>configureCellDisplayWithCardInfo(cardInfo:)</code>æ–¹æ³•ä¸­ï¼Œcellç”Ÿæˆnodeå¹¶æ·»åŠ åˆ°cellä¸Šé¢ï¼Œç„¶åå¸ƒå±€nodesã€‚</li>
</ul>
<p>è¿™æ„å‘³ç€æ¯ä¸€æ¬¡é‡ç”¨cellçš„æ—¶å€™ï¼Œéƒ½ä¼šé‡å¤è¿™äº›åŠ¨ä½œ ã€‚<br>å¦‚æœä½ æ˜¯ç”¨viewsä»£æ›¿nodesï¼Œé‚£è¿™æ ·ç»å¯¹ä¸æ˜¯æœ€å¥½çš„åšæ³•ã€‚ä½†æ˜¯ç°åœ¨ç”¨çš„æ˜¯nodesï¼Œå› ä¸ºnodesçš„ç”Ÿæˆï¼Œå¸ƒå±€ä»¥åŠå¡«å……ï¼Œè¿™äº›æ­¥éª¤éƒ½æ˜¯å¯ä»¥æ”¾åœ¨å¼‚æ­¥çº¿ç¨‹åšçš„ï¼Œæ‰€ä»¥ç›®å‰è¿˜ä¸æ˜¯é—®é¢˜ï¼Œå½“ç„¶æˆ‘ä»¬åç»­è¿˜ä¼šä¼˜åŒ–ã€‚å”¯ä¸€çš„é—®é¢˜æ˜¯è¿™æ ·åšçš„è¯ï¼Œä½ ä¸èƒ½å¾ˆæ–¹ä¾¿çš„å–æ¶ˆè¿™äº›å¼‚æ­¥æ“ä½œæˆ–è€…æ˜¯åœ¨é‡ç”¨cellçš„æ—¶å€™åˆ é™¤nodesã€‚</p>
<p>&gt;</p>
<blockquote>
<p>Note : åœ¨å®é™…çš„å¼€å‘ä¸­ï¼Œä½ å¯ä»¥é€‰æ‹©ä½¿ç”¨ASRangeControlleræ¥ç¼“å­˜nodesï¼Œè¿™æ ·ä½ å°±ä¸éœ€è¦åœ¨æ¯æ¬¡é‡ç”¨cellçš„æ—¶å€™å»é‡æ–°ç”Ÿæˆnodesã€‚</p>
</blockquote>
<h3 id="Adding-the-Background-Image-Node"><a href="#Adding-the-Background-Image-Node" class="headerlink" title="Adding the Background Image Node"></a>Adding the Background Image Node</h3><p>æ‰“å¼€ <code>RainforestCardCell.swift</code> ç„¶åæ›¿æ¢ <code>configureCellDisplayWithCardInfo(cardInfo:)</code> ä¸ºå¦‚ä¸‹:</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">configureCellDisplayWithCardInfo</span><span class="params">(cardInfo: RainforestCardInfo)</span></span> &#123;</span><br><span class="line">  	<span class="comment">//MARK: Image Size Section</span></span><br><span class="line">  	<span class="keyword">let</span> image = <span class="type">UIImage</span>(named: cardInfo.imageName)!</span><br><span class="line">  	featureImageSizeOptional = image.size</span><br><span class="line">  	<span class="comment">//MARK: Node Creation Section</span></span><br><span class="line">  	<span class="keyword">let</span> backgroundImageNode = <span class="type">ASImageNode</span>()</span><br><span class="line">  	backgroundImageNode.image = image</span><br><span class="line">  	backgroundImageNode.contentMode = .<span class="type">ScaleAspectFill</span></span><br><span class="line"> &#125;</span><br></pre></td></tr></table></figure>
<p><code>ASImageNode</code>æ˜¯<code>AsyncDisplayKit</code>ä¸­ç”¨æ¥åšå±•ç¤ºç”¨çš„ä¼—å¤šnodesä¸­çš„ä¸€ç§ï¼Œç­‰ä»·äº<code>UIKit</code>ä¸­çš„<code>UIImageView</code>ï¼Œåªæ˜¯<code>ASImageNode</code>é»˜è®¤æƒ…å†µä¸‹çš„å›¾ç‰‡è§£ç æ“ä½œæ˜¯å¼‚æ­¥çš„ã€‚</p>
<p>åœ¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>çš„æœ«å°¾æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">backgroundImageNode.layerBacked = <span class="literal">true</span></span><br></pre></td></tr></table></figure>
<p>Nodesæœ‰ä¸¤ç§æ¨¡å¼ï¼Œä¸€èˆ¬æƒ…å†µä¸‹å½“éœ€è¦å¤„ç†æŸäº›äº‹ä»¶çš„æ—¶å€™æ¯”å¦‚<code>touch event</code>ï¼Œæˆ‘ä»¬é‡‡ç”¨<code>view-backed</code>æ¨¡å¼ï¼Œåä¹‹å¦‚æœåªæ˜¯çº¯ç²¹çš„å±•ç¤ºåˆ™é‡‡ç”¨<code>layer-backed</code>æ¨¡å¼ï¼Œ<code>layer-backed</code>æ¨¡å¼ç›¸å¯¹è€Œè¨€æ˜¯è½»é‡çº§çš„ï¼Œä¼šæœ‰æ›´å¥½ä¸€ç‚¹çš„æ€§èƒ½ã€‚ç”±äºæˆ‘ä»¬è¿™ä¸ªé¡¹ç›®ä¸­ä¸éœ€è¦å¤„ç†äº‹ä»¶ï¼Œæ‰€ä»¥<code>backgroundImageNode</code>é‡‡ç”¨<code>layer-backed</code>æ¨¡å¼ã€‚</p>
<p>åœ¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>çš„æœ«å°¾ç»§ç»­æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MARK: Node Layout Section</span></span><br><span class="line">backgroundImageNode.frame = <span class="type">FrameCalculator</span>.frameForContainer(featureImageSize: image.size)</span><br></pre></td></tr></table></figure>
<p><code>FrameCalculator</code>æ˜¯ä¸ªè¾…åŠ©ç±»ï¼Œå°è£…äº†cellçš„å¸ƒå±€å¤„ç†ï¼Œè¿”å›æ¯ä¸€ä¸ªnodeçš„frameã€‚å¦‚æœä½ è¦é€‚é…å¤šä¸ªè®¾å¤‡å°ºå¯¸ï¼Œè¿™é‡Œä½ è¦è°¨æ…å¤„ç†ï¼Œä½ å¯ä»¥çœ‹åˆ°è¿™é‡Œæ²¡æœ‰ä½¿ç”¨çº¦æŸï¼Œå› ä¸º<code>AsyncDisplayKit</code>ç›®å‰ç‰ˆæœ¬å¹¶ä¸æ”¯æŒçº¦æŸï¼Œå¸Œæœ›åç»­æ”¯æŒå§ã€‚</p>
<p>åœ¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>çš„æœ«å°¾ç»§ç»­æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">//MARK: Node Layer and Wrap Up Section</span></span><br><span class="line"><span class="keyword">self</span>.contentView.layer.addSublayer(backgroundImageNode.layer)</span><br></pre></td></tr></table></figure>
<p>ä¸Šé¢å·²ç»æåˆ°äº†ï¼Œ<code>AsyncDisplayKit</code>ä¼šä¸º<code>backgroundImageNode</code>åˆ›å»ºä¸€ä¸ªlayerï¼Œä½†æ˜¯ä½ ä»ç„¶éœ€è¦æŠŠè¿™ä¸ªnodeæ·»åŠ åˆ°<code>layer tree</code>ä¸­ï¼Œå®ƒæ‰å¯ä»¥åœ¨å±å¹•ä¸Šæ˜¾ç¤ºã€‚å¦å¤–ç”±äºnodeçš„ç»˜åˆ¶æ˜¯å¼‚æ­¥çš„ï¼Œæ‰€ä»¥åœ¨ç»˜åˆ¶å®Œæˆä¹‹å‰å®ƒæ˜¯ä¸ä¼šæ˜¾ç¤ºçš„ï¼Œå°½ç®¡ä½ å·²ç»æŠŠå®ƒæ·»åŠ åˆ°<code>layer tree</code>ä¸­äº†ï¼Œè¿™ä¸€ç‚¹éœ€è¦æ³¨æ„ã€‚å½“nodeçš„å›¾ç‰‡ç»˜åˆ¶å®Œæˆä¹‹åï¼Œnodeçš„layerçš„contentå°±ä¼šè¢«æ›´æ–°ï¼Œè¿™ä¸ªæ—¶å€™cellçš„ <code>content view</code>çš„layerä¼šæœ‰ä¸¤ä¸ªsublayer.</p>
<p>ä½ åº”è¯¥ä¼šæ³¨æ„åˆ°cellæ¯æ¬¡è¢«å–å‡ºé‡ç”¨çš„æ—¶å€™ï¼Œ<code>configureCellDisplayWithCardInfo(cardInfo:)</code>éƒ½ä¼šè¢«è°ƒç”¨ï¼Œæ‰€ä»¥æ¯æ¬¡è¯¥æ–¹æ³•è°ƒç”¨çš„æ—¶å€™ï¼Œæˆ‘ä»¬éƒ½ä¼šæ·»åŠ ä¸€ä¸ªæ–°çš„layeråˆ°cellçš„contentviewçš„layerä¸Šé¢ï¼Œä¸è¿‡åˆ«æ‹…å¿ƒï¼Œæˆ‘ä»¬é©¬ä¸Šå°±ä¼šè§£å†³è¿™ä¸ªé—®é¢˜ã€‚</p>
<p>åœ¨<code>RainforestCardCell.swift</code>ä¸­æ–°æ·»åŠ ä¸€ä¸ªå˜é‡<code>backgroundImageNode</code>åƒè¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RainforestCardCell</span>: <span class="title">UICollectionViewCell</span> </span>&#123;</span><br><span class="line">  <span class="keyword">var</span> featureImageSizeOptional: <span class="type">CGSize</span>?</span><br><span class="line">  <span class="keyword">var</span> placeholderLayer: <span class="type">CALayer</span>!</span><br><span class="line">  <span class="keyword">var</span> backgroundImageNode: <span class="type">ASImageNode</span>? <span class="comment">///&lt; ADD THIS LINE</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>æ·»åŠ è¿™ä¸ªå±æ€§æˆ‘ä»¬å¯ä»¥æŒæœ‰è¿™ä¸ªnodeï¼Œæ˜¯å› ä¸ºåœ¨<code>ARC</code>ç¯å¢ƒä¸‹ï¼ŒæŸäº›æ—¶å€™å®ƒä¼šè¢«é‡Šæ”¾ï¼Œè¿™æ ·å°±ä¸ä¼šæ˜¾ç¤ºåœ¨å±å¹•ä¸Šäº†ã€‚nodeæ˜¯æŒæœ‰å®ƒçš„layerçš„å¼•ç”¨çš„ï¼Œä½†æ˜¯å®ƒçš„layerå¹¶ä¸æŒæœ‰nodeï¼Œæ‰€ä»¥æˆ‘ä»¬éœ€è¦æŒæœ‰è¿™ä¸ªnodeã€‚</p>
<p>åœ¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>çš„æœ«å°¾ç»§ç»­æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.backgroundImageNode = backgroundImageNode</span><br></pre></td></tr></table></figure>
<p>å¥½äº†ï¼Œç›®å‰ä¸ºæ­¢ï¼Œ<code>configureCellDisplayWithCardInfo(cardInfo:)</code>æ˜¯è¿™æ ·å­çš„ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line"><span class="function"><span class="keyword">func</span> <span class="title">configureCellDisplayWithCardInfo</span><span class="params">(cardInfo: RainforestCardInfo)</span></span> &#123;</span><br><span class="line">  <span class="comment">//MARK: Image Size Section</span></span><br><span class="line">  <span class="keyword">let</span> image = <span class="type">UIImage</span>(named: cardInfo.imageName)!</span><br><span class="line">  featureImageSizeOptional = image.size</span><br><span class="line">  <span class="comment">//MARK: Node Creation Section</span></span><br><span class="line">  <span class="keyword">let</span> backgroundImageNode = <span class="type">ASImageNode</span>()</span><br><span class="line">  backgroundImageNode.image = image</span><br><span class="line">  backgroundImageNode.contentMode = .<span class="type">ScaleAspectFill</span></span><br><span class="line">  backgroundImageNode.layerBacked = <span class="literal">true</span></span><br><span class="line">  <span class="comment">//MARK: Node Layout Section</span></span><br><span class="line">  backgroundImageNode.frame = <span class="type">FrameCalculator</span>.frameForContainer(featureImageSize: image.size)</span><br><span class="line">  <span class="comment">//MARK: Node Layer and Wrap Up Section</span></span><br><span class="line">  <span class="keyword">self</span>.contentView.layer.addSublayer(backgroundImageNode.layer)</span><br><span class="line">  <span class="keyword">self</span>.backgroundImageNode = backgroundImageNode</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘è¿è¡Œï¼Œä½ å¯ä»¥è§‚å¯Ÿåˆ°<code>backgroundImageNode</code>çš„å›¾ç‰‡çš„å¼‚æ­¥å‘ˆç°ï¼Œæ„Ÿè§‰ä¸€ä¸‹æ•ˆæœå§ã€‚<br><img src="http://www.raywenderlich.com/wp-content/uploads/2014/10/IMG_0006.png" alt=""></p>
<p>å¦‚æœä½ è¿è¡Œåœ¨ä¸€ä¸ªè€ä¸€ç‚¹çš„è®¾å¤‡ä¸Šï¼Œä½ ä¼šå‘ç°é‚£äº›cellä¸Šçš„å›¾ç‰‡åƒçˆ†ç±³èŠ±ä¸€æ ·ä¸€ä¸ªä¸ªè·³å‡ºæ¥äº†ï¼Œè¿™å¹¶ä¸æ˜¯æˆ‘ä»¬çš„ç†æƒ³ç»“æœï¼Œè¿™ä¸ªé—®é¢˜æˆ‘ä»¬ä¼šæ”¾åœ¨æœ€åè§£å†³ã€‚</p>
<p>æ­£å¦‚ä¸Šé¢æˆ‘å·²ç»æåˆ°çš„ï¼Œæ¯æ¬¡cellé‡ç”¨çš„æ—¶å€™ï¼Œéƒ½ä¼šæœ‰ä¸€ä¸ªæ–°çš„layerè¢«åŠ ä¸Šå»ï¼Œä½ å¯ä»¥å¿«é€Ÿæ»šåŠ¨é¡µé¢ï¼Œç„¶åæ‰“ä¸ªæ–­ç‚¹åœ¨cellé‡Œé¢ï¼Œä¼šå‘ç°å¾ˆæœ‰å¤šlayeråœ¨ä¸Šé¢ï¼Œæ¥ä¸‹æ¥æˆ‘ä»¬å°±æ¥å¤„ç†è¿™ä¸ªé—®é¢˜ã€‚</p>
<h3 id="Handling-Cell-Reuse"><a href="#Handling-Cell-Reuse" class="headerlink" title="Handling Cell Reuse"></a>Handling Cell Reuse</h3><p>é¦–å…ˆç»§ç»­åœ¨<code>RainforestCardCell.swift</code>, æ·»åŠ ä¸ª<code>contentLayer</code>ï¼Œåƒè¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line"><span class="class"><span class="keyword">class</span> <span class="title">RainforestCardCell</span>: <span class="title">UICollectionViewCell</span> </span>&#123;  </span><br><span class="line">		<span class="keyword">var</span> featureImageSizeOptional: <span class="type">CGSize</span>?</span><br><span class="line">  		<span class="keyword">var</span> placeholderLayer: <span class="type">CALayer</span>!</span><br><span class="line">  		<span class="keyword">var</span> backgroundImageNode: <span class="type">ASImageNode</span>?</span><br><span class="line">  		<span class="keyword">var</span> contentLayer: <span class="type">CALayer</span>? <span class="comment">///&lt; ADD THIS LINE</span></span><br><span class="line">  		...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>åœ¨<code>configureCellDisplayWithCardInfo(cardInfo:)</code>çš„æœ«å°¾ç»§ç»­æ·»åŠ ä¸‹é¢ä¸€è¡Œä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">self</span>.contentLayer = backgroundImageNode.layer</span><br></pre></td></tr></table></figure>
<p>ç„¶åæ›¿æ¢ <code>prepareForReuse()</code>æ–¹æ³•å¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">override</span> <span class="function"><span class="keyword">func</span> <span class="title">prepareForReuse</span><span class="params">()</span></span> &#123;</span><br><span class="line">  	<span class="keyword">super</span>.prepareForReuse()</span><br><span class="line">  	backgroundImageNode?.preventOrCancelDisplay = <span class="literal">true</span></span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç”±äº<code>AsyncDisplayKit</code>å¯ä»¥å¼‚æ­¥ç»˜åˆ¶ï¼Œnodeså¯ä»¥è®©ä½ é˜»æ­¢ä»»ä½•æ­£åœ¨è¿›è¡Œçš„ç»˜åˆ¶ï¼Œå½“ä½ éœ€è¦å–æ¶ˆæˆ–è€…åœæ­¢ç»˜åˆ¶çš„æ—¶å€™åªéœ€è¦è®¾ç½®å®ƒçš„<code>preventOrCancelDisplay</code>ä¸º<code>true</code>å³å¯ï¼Œè¿™æ ·ä½ å°±å¯ä»¥åœ¨cellé‡ç”¨ä¹‹å‰åœæ­¢ä¹‹å‰çš„æ‰€æœ‰ç»˜åˆ¶ï¼Œæ˜¯ä¸æ˜¯å¾ˆèµï¼Ÿ</p>
<p>æ¥ä¸‹æ¥ï¼Œåœ¨<code>prepareForReuse()</code>ä¸­å†æ·»åŠ å‡ è¡Œä»£ç ï¼Œå¦‚ä¸‹ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">contentLayer?.removeFromSuperlayer()</span><br><span class="line">contentLayer = <span class="literal">nil</span></span><br><span class="line">backgroundImageNode = <span class="literal">nil</span></span><br></pre></td></tr></table></figure>
<p>è¿™å‡ è¡Œä»£ç ç®€å•æ˜“æ‡‚ï¼Œå°±æ˜¯åœ¨cellé‡ç”¨ä¹‹å‰ï¼ŒæŠŠç›¸åº”çš„layerå’Œnodeéƒ½åˆ é™¤ï¼Œå¹¶ç¡®ä¿è¢«é‡Šæ”¾æ‰ï¼Œè¿™æ ·å°±è§£å†³äº†ä¸Šé¢æåˆ°çš„layerå †ç§¯çš„é—®é¢˜ã€‚<br>ç¼–è¯‘è¿è¡Œï¼Œè¿™ä¸€æ¬¡å°±ä¸ä¼šæœ‰layerå †ç§¯äº†ï¼Œå¹¶ä¸”åœ¨cellæ»šå‡ºå±å¹•å¯è§†èŒƒå›´åï¼Œå–æ¶ˆä¸å¿…è¦çš„ç»˜åˆ¶ã€‚</p>
<h3 id="Blurring-the-Image"><a href="#Blurring-the-Image" class="headerlink" title="Blurring the Image"></a>Blurring the Image</h3><p>ä¸ºäº†æ·»åŠ bluræ•ˆæœï¼Œéœ€è¦æˆ‘ä»¬åœ¨imagenodeçš„å±•ç¤ºè¿‡ç¨‹ä¸­åŠ å…¥ä¸€äº›æ­¥éª¤ã€‚åœ¨<code>RainforestCardCell.swift</code>æ–‡ä»¶çš„<code>configureCellDisplayWithCardInfo(cardInfo:)</code>æ–¹æ³•ä¸­åšç‚¹ä¿®æ”¹ï¼Œåœ¨<code>backgroundImageNode.layerBacked = true</code>åé¢æ·»åŠ å¦‚ä¸‹ä»£ç ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">backgroundImageNode.imageModificationBlock = &#123; input <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">if</span> input == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> input</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="keyword">if</span> <span class="keyword">let</span> blurredImage = input.applyBlurWithRadius(</span><br><span class="line">    <span class="number">30</span>,</span><br><span class="line">    tintColor: <span class="type">UIColor</span>(white: <span class="number">0.5</span>, alpha: <span class="number">0.3</span>),</span><br><span class="line">    saturationDeltaFactor: <span class="number">1.8</span>,</span><br><span class="line">    maskImage: <span class="literal">nil</span>, </span><br><span class="line">    didCancel:&#123; <span class="keyword">return</span> <span class="literal">false</span> &#125;) &#123;</span><br><span class="line">      <span class="keyword">return</span> blurredImage</span><br><span class="line">  &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> image</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p><code>ASImageNode</code>çš„<code>imageModificationBlock</code>ç»™äº†æˆ‘ä»¬ä¸€ä¸ªæœºä¼šåœ¨å±•ç¤ºåŸå§‹å›¾ç‰‡ä¹‹å‰å¯ä»¥åšä¸€äº›å…¶ä»–çš„æ“ä½œï¼Œæ¯”å¦‚æ»¤é•œæ“ä½œï¼Œæ¨¡ç³Šå¤„ç†ç­‰ã€‚</p>
<p>ä¸Šé¢çš„ä»£ç ï¼Œä½¿ç”¨<code>imageModificationBlock</code>ï¼Œç»™cellçš„èƒŒæ™¯å›¾åŠ ä¸Šäº†æ¨¡ç³Šæ•ˆæœã€‚æœ€å…³é”®çš„ä¸€ç‚¹æ˜¯imagenodeæŠŠç»˜åˆ¶åŠ¨ä½œå’Œè¿™ä¸ªé—­åŒ…æ“ä½œæ”¾åœ¨äº†å­çº¿ç¨‹ï¼Œè¿™æ ·å°±ä½¿ä¸»çº¿ç¨‹è¿è¡Œé¡ºç•…ï¼Œè¿™ä¸ªé—­åŒ…æŠŠåŸå§‹å›¾ç‰‡ä½œä¸ºå‚æ•°ç„¶åè¿”å›å¤„ç†åçš„å›¾ç‰‡ã€‚</p>
<p>è¿™ä¸ªæ¨¡ç³Šå¤„ç†æ˜¯ä½¿ç”¨äº†ç³»ç»Ÿçš„æ–¹æ³•ï¼Œ<code>UIImage</code> çš„ <code>blurring category</code>ï¼Œå®ƒä¸»è¦æ˜¯ä½¿ç”¨<code>Accelerate framework</code> åŸºäº<code>CPU</code>æ¥åšçš„æ¨¡ç³Šæ“ä½œã€‚ç”±äºè¿™ä¸ªæ¨¡ç³Šå¤„ç†ä¼šæ¶ˆè€—å†…å­˜åŒæ—¶ä¹Ÿæ¯”è¾ƒè€—æ—¶ï¼Œæ‰€ä»¥å°±æ”¯æŒäº†å–æ¶ˆæœºåˆ¶ï¼Œ<code>didCancel</code>é—­åŒ…ä¼šè¢«å¤šæ¬¡è°ƒç”¨æ¥ç›‘æµ‹æ˜¯å¦åº”è¯¥å–æ¶ˆæ¨¡ç³Šæ“ä½œã€‚ç›®å‰ä¸ºæ­¢ï¼Œä¸Šé¢çš„ä»£ç åªæ˜¯ç®€å•è¿”å›äº†<code>false</code>ï¼Œç¨åæˆ‘ä»¬å°±ä¼šæ¥å®é™…ä¿®æ”¹<code>didCancel</code>ã€‚</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="type">Note</span> : è¿˜è®°å¾—ä¸€å¼€å§‹çš„æ—¶å€™ä½ æ»‘åŠ¨é¡µé¢çš„æ—¶å€™æ˜¯ä»€ä¹ˆæ„Ÿè§‰ä¹ˆï¼Ÿé‚£ä¸ªæ¨¡ç³Šå¤„ç†ä¸¥é‡çš„é˜»å¡äº†ä¸»çº¿ç¨‹ï¼Œé€šè¿‡<span class="type">AsyncDisplayKit</span>æŠŠè¿™ä¸ªæ“ä½œæ”¾å…¥å­çº¿ç¨‹ï¼Œç°åœ¨å¤§å¤§æå‡äº†collection viewæ»šåŠ¨æ—¶å€™çš„ä½“éªŒã€‚è¿™ç®€ç›´å°±æ˜¯ä¸€ä¸ªå¤©ä¸Šï¼Œä¸€ä¸ªåœ°ä¸‹å•Šï¼Œæœ‰æœ¨æœ‰ï¼Ÿ</span><br></pre></td></tr></table></figure>
<p>è¿è¡Œçœ‹çœ‹ç°åœ¨çš„æ•ˆæœå§ï¼š<br><img src="http://www.raywenderlich.com/wp-content/uploads/2014/10/IMG_0009.png" alt=""></p>
<p>ç°åœ¨ä½ å¯ä»¥çœ‹åˆ°<code>collection view</code>æ»šåŠ¨èµ·æ¥æ˜¯æœ‰å¤šä¹ˆçš„é¡ºæ»‘ã€‚</p>
<p>å½“<code>collection view</code>ä»é‡ç”¨é˜Ÿåˆ—å–å‡ºä¸€ä¸ªcellé‡ç”¨çš„æ—¶å€™å°±å¼€å§‹äº†ä¸€ä¸ªæ¨¡ç³Šå¤„ç†æ“ä½œï¼Œæ‰€ä»¥å½“ä½ å¿«é€Ÿæ»šåŠ¨çš„æ—¶å€™ï¼Œ<code>collection view</code>å°±ä¼šé‡ç”¨æ¯ä¸€ä¸ªcellå¾ˆå¤šæ¬¡ï¼Œç†æ‰€å½“ç„¶çš„å°±å¯åŠ¨äº†å¾ˆå¤šæ¨¡ç³Šå¤„ç†çš„æ“ä½œã€‚è¿™ä¸ªå½“ç„¶ä¸åˆç†äº†ğŸ˜ğŸ˜ï¼Œæ‰€ä»¥æˆ‘ä»¬çš„ç›®æ ‡åº”è¯¥æ˜¯å½“ä¸€ä¸ªcellå¼€å§‹é‡ç”¨çš„æ—¶å€™ï¼Œå»å–æ¶ˆä¹‹å‰çš„æ¨¡ç³Šå¤„ç†æ“ä½œã€‚</p>
<p>åœ¨å‰é¢æˆ‘ä»¬å·²ç»å¯ä»¥åœ¨<code>prepareForReuse()</code>ä¸­å–æ¶ˆnodeçš„ç»˜åˆ¶ï¼Œæ‰€ä»¥ä¸€æ—¦æˆ‘ä»¬æœ‰æœºä¼šåœ¨åˆé€‚çš„æ—¶å€™å–æ¶ˆæ¨¡ç³Šæ“ä½œçš„è¯ï¼Œé‚£å°±æ¯«ä¸çŠ¹è±«çš„å»å–æ¶ˆå§ã€‚</p>
<h3 id="Canceling-the-Blur"><a href="#Canceling-the-Blur" class="headerlink" title="Canceling the Blur"></a>Canceling the Blur</h3><p>ä¸ºäº†å–æ¶ˆé‚£äº›æ­£åœ¨è¿›è¡Œçš„bluræ“ä½œï¼Œæˆ‘ä»¬éœ€è¦é‡æ–°å®ç°bluræ–¹æ³•ä¸­çš„<code>didCancel</code>é—­åŒ…ã€‚æ·»åŠ å¦‚ä¸‹ä»£ç åˆ°<code>imageModificationBlock</code>ä¸­ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br></pre></td><td class="code"><pre><span class="line">backgroundImageNode.imageModificationBlock = &#123; [<span class="keyword">weak</span> backgroundImageNode] input <span class="keyword">in</span></span><br><span class="line">  <span class="keyword">if</span> input == <span class="literal">nil</span> &#123;</span><br><span class="line">    <span class="keyword">return</span> input</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ADD FROM HERE...</span></span><br><span class="line">  <span class="keyword">let</span> didCancelBlur: () -&gt; <span class="type">Bool</span> = &#123;</span><br><span class="line">    <span class="keyword">var</span> isCancelled = <span class="literal">true</span></span><br><span class="line">    <span class="comment">// 1</span></span><br><span class="line">    <span class="keyword">if</span> <span class="keyword">let</span> strongBackgroundImageNode = backgroundImageNode &#123;</span><br><span class="line">      <span class="comment">// 2</span></span><br><span class="line">      <span class="keyword">let</span> isCancelledClosure = &#123;</span><br><span class="line">        isCancelled = strongBackgroundImageNode.preventOrCancelDisplay</span><br><span class="line">      &#125;</span><br><span class="line">      <span class="comment">// 3</span></span><br><span class="line">      <span class="keyword">if</span> <span class="type">NSThread</span>.isMainThread() &#123;</span><br><span class="line">        isCancelledClosure()</span><br><span class="line">      &#125; <span class="keyword">else</span> &#123;</span><br><span class="line">        dispatch_sync(dispatch_get_main_queue(), isCancelledClosure)</span><br><span class="line">      &#125;</span><br><span class="line">    &#125;</span><br><span class="line">    <span class="keyword">return</span> isCancelled</span><br><span class="line">  &#125;</span><br><span class="line">  <span class="comment">// ...TO HERE</span></span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>å¾ˆæ˜æ˜¾ï¼Œæˆ‘ä»¬è¿™é‡Œéœ€è¦ä½¿ç”¨ä¸€ä¸ª<code>weak reference</code>æ¥é¿å…<code>closure</code>å’Œ<code>backgroundImageNode</code>çš„å¾ªç¯å¼•ç”¨ã€‚æˆ‘ä»¬å°±ä½¿ç”¨<code>backgroundImageNode</code>æ¥å†³å®šæ˜¯å¦éœ€è¦å–æ¶ˆæ¨¡ç³Šå¤„ç†ã€‚</p>
<p>ä¸Šé¢çš„ä»£ç å®Œæˆäº†å¦‚ä¸‹å‡ ä¸ªåŠŸèƒ½ï¼š</p>
<ul>
<li>é¦–å…ˆè·å¾—<code>backgroundImageNode</code>çš„ä¸€ä¸ªå¼ºå¼•ç”¨ï¼Œä¸ºæˆ‘ä»¬æ¥ä¸‹æ¥çš„æ“ä½œåšå‡†å¤‡ã€‚å¦‚æœå½“è¿™ä¸ªé—­åŒ…è¿è¡Œçš„æ—¶å€™<code>backgroundImageNode</code>ä¸å­˜åœ¨äº†ï¼Œé‚£ä¹ˆ<code>isCancelled</code>å°±ä¼šä¸º<code>true</code>ï¼Œbluræ“ä½œå°±ä¼šè¢«å–æ¶ˆï¼Œé‚£æˆ‘ä»¬å°±åˆ«æåšä»€ä¹ˆbluræ“ä½œäº†ã€‚</li>
<li>ä½ ä¼šæœ‰ç–‘é—®ï¼Œåœ¨è¿™ä¸ªåœ°æ–¹ä¸ºä»€ä¹ˆå–æ¶ˆblurçš„è¿™ä¸ªé—­åŒ…ä¸­çš„ä»£ç ä¼šè¦æ±‚æ”¾åœ¨ä¸»çº¿ç¨‹æ¥æ“ä½œï¼Œè¿™æ˜¯å› ä¸ºä¸€æ—¦nodeåˆ›å»ºäº†å®ƒçš„<code>layer</code>æˆ–è€…<code>view</code>ä¹‹åï¼Œä½ å°±åªèƒ½åœ¨ä¸»çº¿ç¨‹æ¥è®¿é—®nodeçš„å±æ€§äº†ï¼ˆè¿™ä¸€ç‚¹å¾ˆé‡è¦ï¼‰ã€‚ç”±äºæˆ‘ä»¬éœ€è¦ä½¿ç”¨nodeçš„<code>preventOrCancelDisplay</code>è¿™ä¸ªå±æ€§ï¼Œè€Œæ­¤æ—¶<code>backgroundImageNode</code>çš„layerå·²ç»åˆ›å»ºè¿‡äº†ï¼Œæ‰€ä»¥æˆ‘ä»¬å¿…é¡»æŠŠè¿™ä¸ªç›‘æµ‹æ”¾åœ¨ä¸»çº¿ç¨‹ä¸­ã€‚</li>
<li>ç”±äºæˆ‘ä»¬éœ€è¦ç¡®ä¿<code>isCancelledClosure</code>ä¼šåœ¨ä¸»çº¿ç¨‹æ¥è¢«è°ƒç”¨ï¼Œæ‰€ä»¥å¦‚æœæ˜¯åœ¨ä¸»çº¿ç¨‹å°±ç›´æ¥è®¿é—®<code>preventOrCancelDisplay</code>ï¼Œå¦åˆ™çš„è¯å°±ä½¿ç”¨<code>dispatch_sync</code>æ¥åœ¨ä¸»çº¿ç¨‹è®¿é—®ã€‚ä½ åˆæœ‰ç–‘é—®ä¹ˆğŸ˜ï¼Œè¿™é‡Œåˆä¸ºä»€ä¹ˆä½¿ç”¨<code>dispatch_sync</code>æ¥åŒæ­¥æ‰§è¡Œï¼Œæ˜¯å› ä¸ºæˆ‘ä»¬å¿…é¡»åœ¨<code>didCancelBlur</code>é—­åŒ…è¿”å›ä¹‹å‰ç»™ä¸€ä¸ªæ˜ç¡®çš„ç»“æœï¼Œå³è¿”å›ä¸€ä¸ªç¡®åˆ‡çš„<code>isCancelled</code>å€¼ã€‚</li>
</ul>
<p>æœ€åï¼Œåœ¨è°ƒç”¨<code>applyBlurWithRadius(...)</code>æ–¹æ³•çš„åœ°æ–¹ï¼ŒæŠŠåˆšæ‰æˆ‘ä»¬å®šä¹‰å¥½çš„é—­åŒ…ä½œä¸ºå€¼ä¼ ç»™<code>didCancel</code>è¿™ä¸ªå‚æ•°ï¼Œæ‰€ä»¥ä»£ç çœ‹èµ·æ¥åƒä¸‹é¢è¿™æ ·ï¼š</p>
<figure class="highlight swift"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">if</span> <span class="keyword">let</span> blurredImage = input.applyBlurWithRadius(</span><br><span class="line">  <span class="number">30</span>,</span><br><span class="line">  tintColor: <span class="type">UIColor</span>(white: <span class="number">0.5</span>, alpha: <span class="number">0.3</span>),</span><br><span class="line">  saturationDeltaFactor: <span class="number">1.8</span>,</span><br><span class="line">  maskImage: <span class="literal">nil</span>,</span><br><span class="line">  didCancel: didCancelBlur) &#123;</span><br><span class="line">  ...</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure>
<p>ç¼–è¯‘è¿è¡Œï¼Œä½ ä¼šå‘ç°æœ‰å¾ˆå¤§ä¸åŒï¼Œç°åœ¨å½“cellæ»šå‡ºå±å¹•åï¼Œå®ƒç›¸åº”çš„bluræ“ä½œä¹Ÿä¼šè¢«å–æ¶ˆï¼Œè¿™æ ·æˆ‘ä»¬ä¼šèŠ‚çœå¾ˆå¤šå†…å­˜å¼€é”€ï¼ŒåŒæ—¶å‡å°‘äº†ä¸å¿…è¦çš„CPUæ—¶é—´ç‰‡å ç”¨ã€‚ä½ å°†ä¼šçœ‹åˆ°å·¨å¤§çš„æ€§èƒ½æå‡ï¼Œå°¤å…¶æ˜¯åœ¨é…ç½®ä½ä¸€ç‚¹çš„è®¾å¤‡ä¸Šã€‚</p>
<p>å½“ç„¶äº†ï¼Œä¹Ÿä¸å¯èƒ½æŠŠæ‰€æœ‰çš„æ“ä½œéƒ½æ¬åˆ°å­çº¿ç¨‹ï¼Œæˆ‘ä»¬çš„å¡ç‰‡è¿˜éœ€è¦å…¶ä»–çš„æ•°æ®å±•ç¤ºï¼Œåœ¨æ¥ä¸‹æ¥çš„æ–‡ç« ä¸­ï¼Œæˆ‘ä»¬è¿˜å°†å­¦ä¹ ä»¥ä¸‹å‡ ç‚¹ï¼š</p>
<ul>
<li>åˆ›å»ºä¸€ä¸ªnodeå®¹å™¨æ¥ç»˜åˆ¶å…¶ä»–å†…å®¹å¹¶æ·»åŠ åˆ°ä¸€ä¸ªå•ä¸€çš„<code>CALayer</code>ä¸Šé¢ï¼›</li>
<li>è‡ªå®šä¹‰<code>ASDisplayNode</code>ï¼›</li>
<li>åœ¨å­çº¿ç¨‹æ¥åˆ›å»ºnodeå±‚çº§å¹¶å¸ƒå±€sub nodes</li>
</ul>
<p>æ‰€ä»¥æ¥ä¸‹æ¥ï¼Œæ•¬è¯·æœŸå¾…å§ğŸ˜ŠğŸ˜ŠğŸ˜Š</p>
	  
	</div>


    <!-- share -->
    
        

        
    <!-- JiaThis Button BEGIN -->
    <div class="jiathis_style_24x24">
        <a class="jiathis_button_weixin"></a>
        <a class="jiathis_button_tsina"></a>
        <a class="jiathis_button_twitter"></a>
        <a class="jiathis_button_fb"></a>
        <a class="jiathis_button_googleplus"></a>
        <a class="jiathis_button_linkedin"></a>
        <a class="jiathis_button_copy"></a>
        <a href="http://www.jiathis.com/share" class="jiathis jiathis_txt jtico jtico_jiathis" target="_blank"></a>
        <a class="jiathis_counter_style"></a>
    </div>
    <script type="text/javascript" src="http://v3.jiathis.com/code/jia.js" charset="utf-8"></script>
    <!-- JiaThis Button END -->
    <br>


    
	
	<!-- comment -->
	
<section id="comment">
  <h2 class="title">è¯„è®º</h2>

  
  	 <div class="ds-thread" data-thread-key="2016/03/05/asyncdisplaykit-practice/" data-title="æ·±åº¦å®è·µ AsyncDisplayKit" data-url="http://yoursite.com/2016/03/05/asyncdisplaykit-practice/"></div>  
  
</section>

	</div> <!-- col-md-9/col-md-12 -->
		
	
	<div id="side_meta">
		<div class="col-md-3" id="post_meta"> 

	<!-- date -->
	
	<div class="meta-widget">
	<i class="fa fa-clock-o"></i>
	2016-03-05 
	</div>
	

	<!-- author -->
	
	<div class="meta-widget">
	<i class="fa fa-user"></i>
	å…ƒç›¸ 
	</div>
	

	<!-- toc -->
	<div class="meta-widget">
	
	</div>
	
    <hr>
	
</div><!-- col-md-3 -->

	</div>
		

</div><!-- row -->

<script type="text/javascript">
  var duoshuoQuery = { short_name: 'hujiangios' };
  (function() {
    var ds = document.createElement('script');
    ds.type = 'text/javascript';
    ds.async = true;
    ds.src = 'http://static.duoshuo.com/embed.js';
    ds.charset = 'UTF-8';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(ds);
  })();
</script>



	</div>
  </div>
  <div class="container-narrow">
  <footer> <script async src="https://dn-lbstatics.qbox.me/busuanzi/2.3/busuanzi.pure.mini.js">
</script>
      
<p>
<p>
    æœ¬ç«™æ€»è®¿é—®é‡<span id="busuanzi_value_site_pv"></span>æ¬¡
    æœ¬æ–‡æ€»é˜…è¯»é‡<span id="busuanzi_value_page_pv"></span>æ¬¡ 
</p>
<br>

  &copy; 2016 ç§»åŠ¨å¼€å‘
     
</p> </footer>
</div> <!-- container-narrow -->
  


  
<a id="gotop" href="#">   
  <span>â–²</span> 
</a>

<script src="/js/jquery.imagesloaded.min.js"></script>
<script src="/js/gallery.js"></script>
<script src="/js/bootstrap.min.js"></script>
<script src="/js/main.js"></script>
<script src="/js/search.js"></script> 


<link rel="stylesheet" href="/fancybox/jquery.fancybox.css" media="screen" type="text/css">
<script src="/fancybox/jquery.fancybox.pack.js"></script>
<script type="text/javascript">
(function($){
  $('.fancybox').fancybox();
})(jQuery);
</script>



</body>
   </html>
